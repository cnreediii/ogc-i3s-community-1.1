[[LogicalModel]]

== Logical Model for 2-D Euclidean Space Tiles and Tiling: Normative
This section defines the mandatory and recommended requirements of the core model for 2-D tiling of Euclidean space. These elements are mandatory regardless and independent of the implementation platform, programming languages, encodings, or any other implementation specific and requirements. 

The following figure, based on the Conceptual Model diagram, shows the properties by class (concept) and the relationsips between the classes.

[#img_logical-model,reftext='{figure-caption} {counter:figure-num}']
.Logical Model for partitioning based on tiles in the 2-D Euclidean case.
image::images/tiling-logical-model.png[width=500,align="center"]

=== Restrictions to definitions of key concepts for the tiling of 2-D plane

The general definitions for the key concepts are restricted as follows for the 2-D use case. The key restrictions are highlighted.

`*tile*`: A geometric shape with known properties that is the result of the tiling (tessellation) *of a 2-D plane*.

`*tile set`*: A set of tiles with common properties that meets the definition of the tile scheme and tiled based on the tessellation rules. *Tiles in a tile set are non-overlapping.*

`*tessellation*`: The tiles and associated tile set are generated by a *regular* tessellation *of a 2-D plane*.

=== Base Requirement

==== Requirement 1 - Core

include::requirements/REQ1_core.adoc[]

=== Requirement Class Tile Scheme

The following is the requirements class of the Tile Scheme

Element name: tileSet

include::requirements/rc-tileset-scheme.adoc[]

This requirement class defines the requirements for defining a tile set.

==== Requirement 2 - Tile Set Identifier (ID)

include::requirements/REQ2_core-tileset-id.adoc[]

Each tile set in a tiled data store shall have a unique identifier. This identifier could be a number or an alphanumeric string. For example, the ID could be CodeType, as an adaptation of MD_Identifier class ISO 19115. An example of an alphanumeric identifier might be "Parcels" or "Street Network".

Element name: tileSetIdentifier

==== Requirement 3 - Tile Set Coordinate Reference System (CRS)

include::requirements/REQ3_core-tileset-crs.adoc[]

A tile scheme shall specify a coordinate reference system (CRS) that is consistent for a given tile set. The CRS for a given tile set could be based on an engineering datum or an earth centric datum. The CRS could be restricted to meet very specific requirements, say for visualization of pre-rendered tiles as defined in the WMTS or TMS standards. Further, at the core conceptual level, there is no requirement that all CRSs be the same for all tile sets in a tiled data store. 

Having the same CRS for all tile sets in a data store is a requirement that would be specified in a profile. For example, CDB specifies WGS 84 (EPSG4326) for all tiles.

Element name: tileSetCRS

==== Requirement 4 - Tile Set Units of Measure (UoM)

include::requirements/REQ4_core-tileset-uom.adoc[]

A tile scheme shall specify a unit of measure (UoM) for a tile set, such as meters or feet, that is consistent for any given tile set. The UoM may be specified in the CRS definition or may be different from the CRS definition. At the core conceptual level, there is no requirement that all UoMs be the same for all tile sets in a tiled data store. Having a consistent UoM across all tile sets is a requirement that would be specified in a profile. (Example: “tileSetUoM=ft”)

Element name: tileSetUoM

==== Requirement 5 - Tile Set Extent

include::requirements/REQ5_core-tileset-extent.adoc[]

In any tiling scheme, there are two extents to be considered. The extent of an individual tile and the extent of the tile set. This requirement is for defining the extent of the tile set.

Note: If there is one tile in a tile set, the extents are identical. In this tiling model there is no requirement, such as in DGGS, for a tile or tile set to cover the entire globe. A tile or tile set could have an extent that covers a building site, a city, a county, a country, and so forth. Any restrictions on the extent of a tile or tile set would be specified in one or more requirements in a profile or a profile with extensions of this abstract specification.

Element name: tileSetExtent

==== Requirement 6 - Tile Set Origin

include::requirements/REQ6_core-tileset-origin.adoc[]

The tile set origin defines where the spatial origin reference point is for the entire tile set. Typically, for a GIS implemented in the northern hemisphere, the tile set origin would be specified in the coordinates of CRS using the lower left hand corner. This Abstract Specification does not specify where the origin of a tile set is located. There is also not the requirement that all tile set origins in a tiled data store be the same (although having this rule sure helps downstream!). These rules would be specified in a profile or be specific to an implementation. For example, in WMTS the tile set origin is the upper left corner. In any case, there is a tile set origin. 

Element name: tileSetOrigin

Example: tileSetOrigin=lower_left

=== Tessellation class

Related to the Tile Set Schema is the actual tessellation process used to generate the tile set.

include::requirements/REQ7_core-tessellation.adoc[]

A regular tessellation 2D planar surface can be performed using one of three geometric shapes: squares (rectangles), hexagons, and equilateral triangles. Squares (rectangles) represent the majority of current and past approaches for tesselating a 2d plane in geospatial systems. However, hexagons have been used in a variety of systems and are the normal tessellation method used in a Discrete Global Grid System (DGGS). Typically there are also rules applied to specify the size and or extent for each tesselation type. For example, in a DGGS implementation, equal area hexagons are often used. In WMTS and TMS, each tile in a tile set are the same width and height.

Element name: tessellationType

==== Tessellation Type `square`

If the `tessellationType` is `square`, then the valid following properties _SHALL_ be specified:

[width="90%",options="header"]
|===
|property name|description
|tileWidth| Width of an individual tile. The default units of measure is as specified by tileSetUoM,
|tileHeight|Height of an individual tile. The default units of measure is as specified by tileSetUoM.
|equalArea|If all tiles are to be equal area this is the area in the units of measure specified in tileSetUoM. If `equalarea` is specified then `width` and `height` are not required. If the desired units of measure for the area is different that `tileSetUoM`, then the units property below needs to be specified.
|units|Units of Measure for equal area tiles (e.g. miles, hectares, etc)
|===

==== Tessellation Type `triangle`

If the specified `tesslationType` is `triangle`, then the length of the side of the equilaterial triangle _SHALL_ be specified.

[width="90%",options="header"]
|===
|property name|description
|length|Length of the triangle side in the units of measure specified in TileSetUOM. All three sides of the triangle have the same length.
|===

==== Tessellation Type Hexagon

In geometry, the hexagonal tiling or hexagonal tessellation is a regular tiling of the Euclidean plane, in which three hexagons meet at each vertex. For the purposes of this logical model, a tesellationType `hexagon` _SHALL_ be a regular hexagon. A regular hexagon has vertices equally spaced around a circle and with all sides the same length. Further, the interior angle at each vertex is 120 degrees. 

[width="90%",options="header"]
|===
|property name|description
|length|Length of the hexagonal side in the units of measure specified in TileSetUOM. All six sides of the hexagon have the same length.
|equalarea|If all hexagonal tiles are to be equal area, this property is the area in the units of measure specified in TileSetUOM. If `equalarea` is specified then `length` is not required.
|===

=== Requirements Class Tile Schema

This clause specifies the requirements that define the properties of each individual tile in a tile set. Combined with the Tile Set Schema common properties, there is enough information for any application -server or client - to access, process, analyze, and visualize any geospatial content provided in the tiled structure.

The Tile Schema requirements class is defined as:

include::requirements/rc-tile-schema.adoc[]

==== Requirement 9 - Property Tile Address (ID)

include::requirements/REQ9_core-tile-address.adoc[]

A tile set shall use a spatial referencing method to assign a unique spatial reference (or index) to each tile across the entire tile set.   These indices may be any alphanumeric string including controlled vocabularies such as the USGS quad index, IP address, tile row/column, or other indexing schemes. The default is sequential numbering beginning at the tile located at the tileSet origin. A value of _default_ signifies row/column addressing.

Element name: tileAddress

==== Requirement 10 - Property Tile Origin

include::requirements/REQ10_core-tile-origin.adoc[]

The tile origin defines where the spatial origin reference point is for each individual tile in a tile set. In a GIS being used in the northern hemisphere, this typically would be the lower left hand corner. All tile origin locations (such as lower left) would be the same for all tiles in a tile set. Neither the conceptual model nor the logical model specifies where the origin of a tile is located. These rules would be specified in a profile or be specific to an implementation. In any case, there is always a tile set origin.

Element name: tileOrigin

==== Requirement 11 - Property Tile Reference

include::requirements/REQ11_core-tile-reference.adoc[]

Each tile must be referenced at its centroidstatement.footnote:[This requirement is based on requirements in the OGC DGGS Abstract Specification.]. This is because the centroid is the only location that will provide a systematic and consistent spatial reference point for all tiles in a tile set regardless of their shape. NOTE: The reference information does not need to be physically stored in the tile set store. The reference can be calculated from the tile extents (see requirement 12).

Element name: tileReference

==== Requirement 12 - Property Tile Extent

include::requirements/REQ12_core-tile-extent.adoc[]

Please note that the tile extent does not need to be stored as part of the tile metadata. However, at a minimum the tile extent must be able to be calculated. Tile extents are typically required for building a spatial index statement.footnote:[A tile index provides an efficient (fast) mechanism for finding any tile or set of tiles in a tiled data store when using a spatial filter, including a point and query operation. Typical spatial indexing are R-Trees and Quad-Trees. The conceptual model specifies no requirements for how a spatial index is constructed or the technology used. However, the tile extents, tile addresses, and tile references can be used to populate a spatial index, such as an R-Tree.], such as an R-Tree.

Element name: tileExtent

=== Recommended Tile Set Metadata Class

Providing more complete metadata for a tile set ensures enhanced provenance and quality of service for any content provided in a tiled structure. 

The following suggested metadata elements are extracted from the OGC Tile Matrix Set candidate standard. Additional metadata elements may be added to this table. If additional metadata elements are required, the OGC CDB Standard provides an enumeration of the most common metadata standards used in the geospatial industry (Volume 1 Clause 5.1.6). The CDB Standard also provides a more detailed list of key metadata elements.

[width="90%",options="header"]
|===
|Element|Description|Reference|
|title|Title of the tile set, normally used for display to a human|LanguageString data structure, see Figure 15 in OWS Common [OGC 06-121r9]|Zero or more (optional) Include when available and useful. Include one for each language represented.
|abstract|Brief narrative description of the tile set, normally available for display to a human|LanguageString data structure, see Figure 15 in OWS Common [OGC 06-121r9]|Zero or more (optional) Include when available and useful Include one for each language represented
|keywords|Unordered list of one or more commonly used or formalized word(s) or phrase(s) used to describe this tile set.|	MD_Keywords class in ISO 19115|Zero or more (optional) One for each keyword authority used
|===

=== Notes on Tile Indices and Tile Pyramids

==== Tile indexes
A tile index provides an efficient (fast) mechanism for finding any tile or set of tiles in a tiled data store when using a spatial filter, including a point and query operation. Typical spatial indexing are R-Trees and Quad-Trees. The logical model specifies no requirements for how a spatial index is constructed or the technology used. However, the tile extents, tile addresses, and tile references can be used to populate a spatial index, such as an R-Tree.

==== Tile Pyramids

A tile pyramid structure would be specified as a set of rules (requirements) applied using the core logical model.  A tile pyramid is usually based on using a square tile tessellation for some area of interest and a common tile set extent for all tile sets that define the pyramid. The base of the pyramid could be one tile whose extent is identical to that of the tile set. The next tile set (level in the pyramid) could divide the tile set extent into 4 tiles. The next tile set could be based on dividing the tile set extent into 16 tiles and so forth. The OGC Tile Matrix Set candidate standard covers this topic extensively.

